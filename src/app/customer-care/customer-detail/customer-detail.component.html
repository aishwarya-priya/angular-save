<h4 class="title">
  Customer Detail
  <div style="float:right">
    <button mat-button (click)="back()" color="primary">
      <mat-icon style="font-size:18px">arrow_back</mat-icon>
      Back
    </button>
  </div>
</h4>

<!-- <div class="flex-container">
    <div class="flex-item-6"> -->
<div class="flex-container">
  <mat-card class="flex-item-6">
    <div class="flex-container flex-end">
      <div>
        <mat-icon class="pointer" (click)="changeEdit()"> edit_note </mat-icon>
      </div>
    </div>
    <form [formGroup]="form" (ngSubmit)="onFormSubmit()" autocomplete="off">
      <mat-card>
        <h5 class="title">Insurance Detail</h5>
        <div class="flex-container">
          <mat-form-field class="flex-item">
            <mat-label>Insurance Provider</mat-label>
            <mat-icon matPrefix>perm_identity</mat-icon>
            <mat-select formControlName="InsuranceProvider">
              <mat-option
                *ngFor="let provider of providerList"
                [value]="provider.id"
              >
                {{ provider.name }}
              </mat-option>
            </mat-select>
            <mat-error
              ><span
                *ngIf="
                  form.controls.InsuranceProvider.touched &&
                  form.controls.InsuranceProvider.invalid
                "
              >
                Please select a insurance provider</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Policy ID</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="PolicyNo"
            />
            <mat-icon matPrefix>policy_outlined</mat-icon>
            <mat-error
              ><span
                *ngIf="
                  form.controls.PolicyNo.touched &&
                  form.controls.PolicyNo.invalid
                "
              >
                Please enter Policy Id</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Member ID</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="MemberId"
            />
            <mat-icon matPrefix>card_membership_outlined </mat-icon>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Agent Name</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="AgentName"
            />
            <mat-icon matPrefix> person_pin</mat-icon>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Agent Code</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="AgentCode"
            />
            <mat-icon matPrefix> confirmation_number</mat-icon>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Agent Number</mat-label>
            <input
              matInput
              [disabled]="true"
              placeholder="Placeholder"
              formControlName="AgentNumber"
              pattern="\d*"
              maxlength="10"
            />
            <mat-icon matPrefix> memory</mat-icon>
          </mat-form-field>
        </div>
      </mat-card>
      <div class="space"></div>
      <mat-card>
        <h5 class="title">Customer Detail</h5>
        <div class="flex-container">
          <mat-form-field class="flex-item">
            <mat-label>Customer Name</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="CustomerName"
            />
            <mat-icon matPrefix> person_pin</mat-icon>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Gender</mat-label>
            <mat-select [disabled]="disableEdit" formControlName="Gender">
              <mat-option *ngFor="let state of genderList" [value]="state">
                {{ state }}
              </mat-option>
            </mat-select>
            <mat-icon matPrefix> supervisor_account</mat-icon>
            <mat-error
              ><span
                *ngIf="
                  form.controls.Gender.touched && form.controls.Gender.invalid
                "
              >
                Please select a Gender</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>DOB</mat-label>

            <input
              matInput
              formControlName="DOB"
              [matDatepicker]="releasedAtPicker"
            />

            <mat-datepicker-toggle matPrefix [for]="releasedAtPicker">
            </mat-datepicker-toggle>

            <mat-datepicker #releasedAtPicker [disabled]="disableEdit">
            </mat-datepicker>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Mobile number</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="CustomerNo"
              required
              pattern="\d*"
              maxlength="10"
            />
            <mat-icon matPrefix>dialpad</mat-icon>
            <mat-error
              ><span
                *ngIf="
                  form.controls.CustomerNo.touched &&
                  form.controls.CustomerNo.invalid
                "
              >
                Please enter mobile number</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>City</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="City"
              required
            />
            <mat-icon matPrefix> location_city</mat-icon>
            <mat-error
              ><span
                *ngIf="form.controls.City.touched && form.controls.City.invalid"
              >
                Please enter city</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>State</mat-label>
            <mat-icon matPrefix>location_searching_outlined</mat-icon>
            <mat-select formControlName="State" required>
              <mat-option *ngFor="let state of stateList" [value]="state">
                {{ state }}
              </mat-option>
            </mat-select>
            <mat-error
              ><span
                *ngIf="
                  form.controls.State.touched && form.controls.State.invalid
                "
              >
                Please select a state</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>Pincode</mat-label>
            <input
              matInput
              placeholder="Placeholder"
              formControlName="Pincode"
              pattern="\d*"
              maxlength="6"
              required
            />
            <mat-icon matPrefix> pin_drop</mat-icon>
            <mat-error
              ><span
                *ngIf="
                  form.controls.Pincode.touched && form.controls.Pincode.invalid
                "
              >
                Please enter pincode</span
              >
            </mat-error>
          </mat-form-field>
          <mat-form-field class="flex-item">
            <mat-label>LabTests</mat-label>
            <mat-select
              placeholder="LabTests"
              formControlName="LabTests"
              [(value)]="SelectedLabTests"
              multiple
            >
              <mat-option *ngFor="let test of LabTests" [value]="test">{{
                test.name
              }}</mat-option>
            </mat-select>
            <mat-error
              ><span
                *ngIf="
                  form.controls.LabTests.touched &&
                  form.controls.LabTests.invalid
                "
              >
                Please select a test</span
              >
            </mat-error>
            <mat-icon matPrefix> find_in_page</mat-icon>
          </mat-form-field>
        </div>
      </mat-card>
      <div class="flex-container" *ngIf="!disableEdit">
        <div class="bottom-pane">
          <button mat-raised-button color="primary">save</button>
          <button mat-raised-button extended (click)="reset()">Clear</button>
        </div>
      </div>
    </form>
  </mat-card>

  <mat-card class="flex-item-6">
    <div class="flex-container flex-end">
      <div class="flex-item" style="line-height: 39px;" *ngIf="!showAppoinment">
        Status :
        <span style="line-height: 39px;color:blue">{{
          appointments.status
        }}</span>
      </div>
      <div class="flex-item">
        <button
          mat-raised-button
          color="primary"
          *ngIf="showAppoinment"
          (click)="showbookAppoinment()"
        >
          Book An Appoinment
        </button>
      </div>
      <div class="flex-item">
        <button mat-button color="primary" (click)="noResponse()">
          No Response
        </button>
      </div>
    </div>
    <ng-container *ngIf="appointments">
      <ng-container *ngFor="let appointment of appointments.appointments">
        <mat-card>
          <div class="flex-container">
            <div class="flex-item">
              <div class="row">
                <div class="col-1 bold">Type Of Visit</div>
                <div class="col-2">{{ appointment.typeOfVisit }}</div>
              </div>
              <div class="row">
                <div class="col-1 bold">DC Details</div>
                <div class="col-2">
                  <ng-container *ngIf="appointment.dcDetails">
                    <span class="bold">
                      {{ appointment.dcDetails.name + ', ' }} </span
                    >{{
                      appointment.dcDetails.address +
                        ', ' +
                        appointment.dcDetails.city +
                        ', ' +
                        appointment.dcDetails.state +
                        ',' +
                        appointment.dcDetails.pinCode
                    }}
                  </ng-container>
                </div>
              </div>
              <div class="row">
                <div class="col-1 bold">Preferred Date</div>
                <div class="col-2">
                  {{ appointment.PreferredDate | date: 'dd/MM/yyyy' }}
                </div>
              </div>
              <div class="row">
                <div class="col-1 bold">Preferred Time</div>
                <div class="col-2">
                  {{ appointment.PreferredTime | date: 'hh:mm' }}
                </div>
              </div>
              <div class="row">
                <div class="col-1 bold">Tests</div>
                <div class="col-2">{{ appointment.test.join(',') }}</div>
              </div>
            </div>
            <div class="flex-item">
              <div class="row buttons">
                <div class="col-1">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="rebookAppoinment()"
                  >
                    ReAppointment
                  </button>
                </div>

                <div class="col-1">
                  <button mat-raised-button color="primary" (click)="show()">
                    Show
                  </button>
                </div>

                <div class="col-1">
                  <button mat-raised-button color="primary" (click)="noShow()">
                    No Show
                  </button>
                </div>

                <div class="col-1">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="partialyCompleted()"
                  >
                    Partially Completed
                  </button>
                </div>

                <div class="col-1">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="reportPending()"
                  >
                    Report Pending
                  </button>
                </div>

                <div class="col-1">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="QcProcess()"
                  >
                    Qc in Progress
                  </button>
                </div>

                <div class="col-1">
                  <button mat-raised-button color="primary">
                    Upload Report
                  </button>
                </div>
              </div>
            </div>
          </div>
        </mat-card>
      </ng-container>
    </ng-container>
  </mat-card>
</div>
